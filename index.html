<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DYMTARDS - ON BASE</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- STİLLER (Değişiklik Yok) --- */
        :root { --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: var(--font-main); }
        body { background: linear-gradient(135deg, #240b36 0%, #c31432 50%, #ff9966 100%); height: 100vh; overflow: hidden; display: flex; align-items: center; justify-content: center; color: #333; }
        .container { display: flex; width: 90%; height: 90%; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px); border: 6px solid #000; border-radius: 30px; box-shadow: 15px 15px 0px rgba(0,0,0,0.6); overflow: hidden; position: relative; z-index: 1; }
        .left-panel { flex: 0 0 40%; display: flex; flex-direction: column; justify-content: center; align-items: center; border-right: 6px solid #000; background: rgba(0, 0, 0, 0.2); padding: 40px; gap: 30px; }
        .logo { font-size: 3.5rem; font-weight: 900; color: #ffcc00; text-shadow: 4px 4px 0 #000; letter-spacing: 2px; text-align: center; line-height: 1; text-transform: uppercase; }
        .logo span { display: block; font-size: 1.5rem; color: #fff; font-weight: 700; text-shadow: 2px 2px 0 #000; margin-top: 5px; letter-spacing: normal; }
        .button-group { display: flex; flex-direction: column; width: 100%; align-items: center; gap: 20px; }
        .action-btn { width: 80%; max-width: 350px; font-size: 1.4rem; font-weight: 900; padding: 15px 20px; border: 4px solid #000; border-radius: 12px; cursor: pointer; box-shadow: 6px 6px 0px #000; transition: all 0.1s; text-transform: uppercase; letter-spacing: 1px; }
        .action-btn:hover { transform: translate(-2px, -2px); box-shadow: 8px 8px 0px #000; filter: brightness(1.1); }
        .action-btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #000; }
        .connect-btn { background: linear-gradient(to right, #ff512f, #dd2476); color: #fff; }
        .about-btn { background: #fff; color: #000; }
        .socials { display: flex; gap: 20px; margin-top: 10px; }
        .social-btn { width: 70px; height: 70px; background: #fff; border: 4px solid #000; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 5px 5px 0px #000; text-decoration: none; transition: all 0.2s; overflow: hidden; padding: 0; }
        .social-btn img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .social-btn:hover { transform: translateY(-5px); box-shadow: 8px 8px 0px #000; }
        .right-panel { flex: 1; background-color: #fcecd6; display: flex; align-items: center; justify-content: center; position: relative; background-image: radial-gradient(#d4a775 1.5px, transparent 1.5px); background-size: 30px 30px; }
        .carousel-container { display: flex; align-items: center; gap: 20px; width: 100%; justify-content: center; }
        .nav-btn { background: #ff512f; border: 3px solid #000; width: 60px; height: 60px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; color: white; box-shadow: 4px 4px 0px #000; transition: 0.1s; z-index: 10; }
        .nav-btn:hover { transform: scale(1.1); }
        .nav-btn:active { transform: scale(0.9); box-shadow: 1px 1px 0px #000; }
        .image-card { width: 450px; height: 450px; background: #000; border: 6px solid #000; border-radius: 20px; box-shadow: 12px 12px 0px rgba(0,0,0,0.5); overflow: hidden; cursor: pointer; transition: transform 0.3s; position: relative; }
        .image-card:hover { transform: rotate(-2deg) scale(1.02); }
        .click-hint { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.7); color: #fff; text-align: center; padding: 12px; font-weight: 700; font-size: 1rem; letter-spacing: 1px; opacity: 0; transition: opacity 0.3s; }
        .image-card:hover .click-hint { opacity: 1; }
        .slider-img { width: 100%; height: 100%; object-fit: cover; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; z-index: 999; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        .modal-box { background: #fff; border: 6px solid #000; border-radius: 20px; box-shadow: 20px 20px 0px #c31432; padding: 30px; max-width: 800px; width: 90%; position: relative; transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .modal-overlay.active .modal-box { transform: scale(1); }
        .close-btn { position: absolute; top: -25px; right: -25px; width: 50px; height: 50px; background: #ff0000; color: white; border: 4px solid #000; border-radius: 50%; font-size: 1.5rem; cursor: pointer; display: flex; justify-content: center; align-items: center; box-shadow: 4px 4px 0 #000; z-index: 10; }
        .close-btn:hover { transform: scale(1.1); }
        .modal-content-nft { display: flex; gap: 30px; }
        .modal-img-container { flex: 1; border: 4px solid #000; border-radius: 15px; overflow: hidden; box-shadow: 5px 5px 0 rgba(0,0,0,0.2); }
        .modal-img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .modal-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .modal-title, .about-title, .wallet-title { font-size: 2.5rem; font-weight: 900; color: #c31432; text-shadow: 1px 1px 0 #000; margin-bottom: 20px; text-transform: uppercase; letter-spacing: -1px; }
        .modal-title { border-bottom: 4px solid #000; padding-bottom: 15px; }
        .meta-row { display: flex; align-items: center; justify-content: space-between; background: #f8f8f8; margin-bottom: 10px; padding: 12px 15px; border: 2px solid #000; border-radius: 8px; font-weight: 700; color: #333; }
        .meta-left { display: flex; flex-direction: column; }
        .meta-label { font-size: 0.8rem; color: #666; margin-bottom: 4px; text-transform: uppercase; font-weight: 600; }
        .meta-value { color: #000; font-size: 1.1rem; }
        .meta-rarity { background: #ff9966; color: #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.85rem; border: 2px solid #000; box-shadow: 2px 2px 0 #000; font-weight: 800; }
        .modal-content-about, .modal-content-wallet { text-align: center; }
        .about-text { font-size: 1.1rem; line-height: 1.6; margin-bottom: 20px; font-weight: 500; color: #222; }
        .about-stats { display: flex; justify-content: center; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .stat-box { background: #fff; border: 3px solid #000; border-radius: 10px; padding: 15px 25px; box-shadow: 4px 4px 0 #000; }
        .stat-label { font-size: 0.9rem; color: #555; display: block; font-weight: 700; text-transform: uppercase; }
        .stat-value { font-size: 1.6rem; color: #000; font-weight: 900; }
        .form-step { display: none; flex-direction: column; align-items: center; gap: 20px; }
        .form-step.active-step { display: flex; }
        .input-box { width: 80%; max-width: 400px; padding: 15px; font-size: 1.2rem; border: 3px solid #000; border-radius: 8px; background: #f9f9f9; font-weight: 600; color: #000; box-shadow: 4px 4px 0 rgba(0,0,0,0.2); outline: none; }
        .input-box::placeholder { color: #999; font-weight: 400; }
        .input-box:focus { background: #fff; border-color: #ff512f; }
        .error-text { color: #d32f2f; font-weight: 700; font-size: 1rem; display: none; margin-top: -10px; }
        .submit-btn-modal { background: #ff512f; color: #fff; padding: 12px 35px; font-size: 1.2rem; font-weight: 800; border: 3px solid #000; border-radius: 8px; cursor: pointer; box-shadow: 4px 4px 0 #000; text-transform: uppercase; }
        .submit-btn-modal:hover { transform: translate(-2px, -2px); box-shadow: 6px 6px 0 #000; }
        .submit-btn-modal:active { transform: translate(2px, 2px); box-shadow: 1px 1px 0 #000; }
        @media (max-width: 900px) {
            .container { flex-direction: column; overflow-y: auto; height: 95vh; }
            .left-panel { border-right: none; border-bottom: 6px solid #000; padding: 30px; width: 100%; flex: none;}
            .right-panel { min-height: 500px; }
            .modal-content-nft { flex-direction: column; }
            .modal-box { overflow-y: auto; max-height: 85vh; padding: 20px; }
            .image-card { width: 280px; height: 280px; }
            .button-group { width: 100%; }
            .logo { font-size: 2.8rem; }
            .about-title, .wallet-title, .modal-title { font-size: 2rem; }
            .input-box { font-size: 1.1rem; width: 100%; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- SOL PANEL -->
        <div class="left-panel">
            <div class="logo">
                DYMTARDS
                <span>ON BASE</span>
            </div>

            <!-- Buton Grubu -->
            <div class="button-group">
                <button class="action-btn connect-btn" id="openWalletBtn">
                    WALLET
                </button>
                <button class="action-btn about-btn" id="openAboutBtn">
                    ABOUT
                </button>
            </div>

            <!-- Sosyal Medya İkonları -->
            <div class="socials">
                <a href="#" class="social-btn opensea" title="OpenSea">
                    <img src="https://media.discordapp.net/attachments/1468931139694628884/1468931271379128477/OpenSea.png?ex=6985d05a&is=69847eda&hm=f16591608b182c7f1efa4e1dbc6a87692f558a63ccf993313a5cf8b3e5a627b8&=&format=webp&quality=lossless&width=590&height=590" alt="OpenSea Logo">
                </a>
                <a href="#" class="social-btn discord" title="Discord">
                    <img src="https://media.discordapp.net/attachments/1468931139694628884/1468931530901688330/Discord.png?ex=6985d098&is=69847f18&hm=0658f269aa45f6a33d457f91e54418d7f59da50900c35d4132e372ed53009e65&=&format=webp&quality=lossless&width=590&height=590" alt="Discord Logo">
                </a>
                <a href="#" class="social-btn twitter" title="X (Twitter)">
                    <img src="https://media.discordapp.net/attachments/1468931139694628884/1468931514908807280/X.png?ex=6985d094&is=69847f14&hm=b985d83e178300247c03457dc3e45e5eda9dd9080b6716558016eb2da1c2bc32&=&format=webp&quality=lossless&width=590&height=590" alt="X (Twitter) Logo">
                </a>
            </div>
        </div>

        <!-- SAĞ PANEL -->
        <div class="right-panel">
            <div class="carousel-container">
                <button class="nav-btn prev" id="prevBtn"><i class="fa-solid fa-arrow-left"></i></button>
                <div class="image-card" id="mainCard">
                    <img src="" alt="NFT" class="slider-img" id="sliderImage">
                    <div class="click-hint">CLICK FOR DETAILS</div>
                </div>
                <button class="nav-btn next" id="nextBtn"><i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>
    </div>

    <!-- POP-UP 1: NFT DETAYLARI -->
    <div class="modal-overlay" id="nftModal">
        <div class="modal-box">
            <div class="close-btn" id="closeNftModal"><i class="fa-solid fa-times"></i></div>
            
            <div class="modal-content-nft">
                <div class="modal-img-container">
                    <img src="" alt="" class="modal-img" id="modalImage">
                </div>
                
                <div class="modal-info">
                    <h2 class="modal-title" id="modalTitle">NFT NAME #000</h2>
                    <div id="metadataContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- POP-UP 2: ABOUT BİLGİLERİ -->
    <div class="modal-overlay" id="aboutModal">
        <div class="modal-box">
            <div class="close-btn" id="closeAboutModal"><i class="fa-solid fa-times"></i></div>
            
            <div class="modal-content-about">
                <h2 class="about-title">THE DYMTARDS</h2>
                <p class="about-text">
                    Dymtards are a collection of 3,333 unique and degenerate characters living on the Base blockchain.
                    Each Dymtard is algorithmically generated from over 150 traits with varying rarities.
                </p>
                <p class="about-text">
                    No roadmap, no promises, just vibes and chaos. Join the movement and embrace the dymness!
                </p>

                <div class="about-stats">
                    <div class="stat-box">
                        <span class="stat-label">SUPPLY</span>
                        <span class="stat-value">3,333</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">CHAIN</span>
                        <span class="stat-value">BASE</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">PRICE</span>
                        <span class="stat-value">FREE</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- POP-UP 3: WALLET -->
    <div class="modal-overlay" id="walletModal">
        <div class="modal-box">
            <div class="close-btn" id="closeWalletModal"><i class="fa-solid fa-times"></i></div>
            
            <div class="modal-content-wallet">
                <h2 class="wallet-title">JOIN WL</h2>
                
                <div class="form-step active-step" id="step1">
                    <p class="about-text">ENTER YOUR X USERNAME</p>
                    <input type="text" class="input-box" id="xInput" placeholder="@username">
                    <span class="error-text" id="xError">USERNAME MUST START WITH @</span>
                    <button class="submit-btn-modal" id="nextWalletBtn">NEXT</button>
                </div>

                <div class="form-step" id="step2">
                    <p class="about-text">ENTER YOUR WALLET</p>
                    <input type="text" class="input-box" id="walletAddressInput" placeholder="0x...">
                    <button class="submit-btn-modal" id="submitWalletBtn">SUBMIT</button>
                </div>

                <div class="form-step" id="step3">
                    <i class="fa-solid fa-check-circle" style="font-size: 5rem; color: #4CAF50; margin-bottom:15px;"></i>
                    <p class="about-text" style="color: #4CAF50; font-size: 2rem; font-weight:900;">REGISTERED!</p>
                </div>
                
                <div class="form-step" id="stepError">
                    <i class="fa-solid fa-times-circle" style="font-size: 5rem; color: #d32f2f; margin-bottom:15px;"></i>
                    <p class="about-text" style="color: #d32f2f; font-size: 1.5rem; font-weight:900;">SERVER ERROR!</p>
                    <p class="about-text">Try again later.</p>
                </div>

            </div>
        </div>
    </div>

    <script>
        const nftCollection = [
            {
                id: 1,
                name: "Dymtard #005 (Jel)",
                image: "https://media.discordapp.net/attachments/1468931139694628884/1468933294232965377/Jel.png?ex=6985d23c&is=698480bc&hm=1660e5cbec43d7a5c992dae1775c16a5b2e6ae8cc48024a2a8bf4ae433600e48&=&format=webp&quality=lossless&width=497&height=497",
                traits: [
                    { type: "Background", value: "Abstract Blue", rarity: "10%" },
                    { type: "Skin", value: "Jelly", rarity: "3%" },
                    { type: "Head", value: "None", rarity: "40%" },
                    { type: "Mouth", value: "Open Smile", rarity: "18%" }
                ]
            },
            {
                id: 2,
                name: "Dymtard #006 (Fire)",
                image: "https://media.discordapp.net/attachments/1468931139694628884/1468933293478121565/Fire.png?ex=6985d23c&is=698480bc&hm=a0f60b3bfebba31d6f835767db6e0e102336f7846e9f1c762aca0381b631bcde&=&format=webp&quality=lossless&width=497&height=497",
                traits: [
                    { type: "Background", value: "Fiery Vortex", rarity: "6%" },
                    { type: "Skin", value: "Lava Red", rarity: "2%" },
                    { type: "Head", value: "Flame Hair", rarity: "4%" },
                    { type: "Mouth", value: "Angry", rarity: "9%" }
                ]
            },
            {
                id: 3,
                name: "Dymtard #007 (Mummy)",
                image: "https://media.discordapp.net/attachments/1468931139694628884/1468933295025684681/Mummy.png?ex=6985d23c&is=698480bc&hm=ef4b05186a19cd7c8050bf18bd961c5ea6ee9c0ab6c00a0c576b86b0515edff9&=&format=webp&quality=lossless&width=497&height=497",
                traits: [
                    { type: "Background", value: "Desert Night", rarity: "8%" },
                    { type: "Skin", value: "Bandaged", rarity: "3%" },
                    { type: "Head", value: "Pharaoh Crown", rarity: "2%" },
                    { type: "Mouth", value: "Mouth Wrap", rarity: "7%" }
                ]
            }
        ];

        let currentIndex = 0;
        const sliderImg = document.getElementById('sliderImage');
        const mainCard = document.getElementById('mainCard');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const nftModal = document.getElementById('nftModal');
        const closeNftModal = document.getElementById('closeNftModal');
        const modalImage = document.getElementById('modalImage');
        const modalTitle = document.getElementById('modalTitle');
        const metadataContainer = document.getElementById('metadataContainer');
        const aboutModal = document.getElementById('aboutModal');
        const openAboutBtn = document.getElementById('openAboutBtn');
        const closeAboutModal = document.getElementById('closeAboutModal');
        const walletModal = document.getElementById('walletModal');
        const openWalletBtn = document.getElementById('openWalletBtn');
        const closeWalletModal = document.getElementById('closeWalletModal');
        const nextWalletBtn = document.getElementById('nextWalletBtn');
        const submitWalletBtn = document.getElementById('submitWalletBtn');
        const xInput = document.getElementById('xInput');
        const xError = document.getElementById('xError');
        const walletAddressInput = document.getElementById('walletAddressInput');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const stepError = document.getElementById('stepError');

        updateSlider();

        function updateSlider() {
            sliderImg.src = nftCollection[currentIndex].image;
        }

        nextBtn.addEventListener('click', () => {
            currentIndex++;
            if(currentIndex >= nftCollection.length) currentIndex = 0;
            updateSlider();
        });

        prevBtn.addEventListener('click', () => {
            currentIndex--;
            if(currentIndex < 0) currentIndex = nftCollection.length - 1;
            updateSlider();
        });

        mainCard.addEventListener('click', () => {
            const data = nftCollection[currentIndex];
            modalImage.src = data.image;
            modalTitle.innerText = data.name;

            metadataContainer.innerHTML = '';
            data.traits.forEach(trait => {
                const row = document.createElement('div');
                row.className = 'meta-row';
                row.innerHTML = `
                    <div class="meta-left">
                        <span class="meta-label">${trait.type}</span>
                        <span class="meta-value">${trait.value}</span>
                    </div>
                    <div class="meta-rarity">
                        ${trait.rarity}
                    </div>
                `;
                metadataContainer.appendChild(row);
            });
            nftModal.classList.add('active');
        });

        closeNftModal.addEventListener('click', () => {
            nftModal.classList.remove('active');
        });

        openAboutBtn.addEventListener('click', () => {
            aboutModal.classList.add('active');
        });

        closeAboutModal.addEventListener('click', () => {
            aboutModal.classList.remove('active');
        });

        openWalletBtn.addEventListener('click', () => {
            step1.classList.add('active-step');
            step2.classList.remove('active-step');
            step3.classList.remove('active-step');
            if(stepError) stepError.style.display = 'none';
            xInput.value = '';
            walletAddressInput.value = '';
            xError.style.display = 'none';
            walletModal.classList.add('active');
        });

        closeWalletModal.addEventListener('click', () => {
            walletModal.classList.remove('active');
        });

        nextWalletBtn.addEventListener('click', () => {
            const val = xInput.value.trim();
            if(val.startsWith('@') && val.length > 1) {
                xError.style.display = 'none';
                step1.classList.remove('active-step');
                step2.classList.add('active-step');
            } else {
                xError.style.display = 'block';
            }
        });

        // --- BACKEND İŞLEMİ (GÜNCELLENDİ) ---
        submitWalletBtn.addEventListener('click', async () => {
            const username = xInput.value.trim();
            const wallet = walletAddressInput.value.trim();

            if (!wallet) {
                alert("Please enter a wallet address!");
                return;
            }

            // Butonu kilitle
            submitWalletBtn.disabled = true;
            submitWalletBtn.innerText = "SENDING...";

            try {
                // RELATIVE PATH KULLANIYORUZ (Render'da Backend ve Frontend aynı yerde)
                const response = await fetch('/api/save-wallet', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: username,
                        wallet: wallet
                    })
                });

                const result = await response.json();

                if (result.success) {
                    step2.classList.remove('active-step');
                    step3.classList.add('active-step');
                    
                    // 2 saniye sonra modalı kapat
                    setTimeout(() => {
                        walletModal.classList.remove('active');
                        // Butonu sıfırla
                        submitWalletBtn.disabled = false;
                        submitWalletBtn.innerText = "SUBMIT";
                    }, 2000);
                } else {
                    alert('Error: ' + result.message);
                    submitWalletBtn.disabled = false;
                    submitWalletBtn.innerText = "SUBMIT";
                }
            } catch (error) {
                console.error("Server hatası:", error);
                step2.classList.remove('active-step');
                if(stepError) {
                    stepError.classList.add('active-step');
                    stepError.style.display = 'flex';
                }
                submitWalletBtn.disabled = false;
                submitWalletBtn.innerText = "SUBMIT";
            }
        });

        window.addEventListener('click', (e) => {
            if (e.target === nftModal) nftModal.classList.remove('active');
            if (e.target === aboutModal) aboutModal.classList.remove('active');
            if (e.target === walletModal) walletModal.classList.remove('active');
        });
    </script>
</body>
</html>